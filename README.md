# Gemini-Drafting-Factory (Gemini 绘图工厂)

Gemini-Drafting-Factory 是一个基于 OpenAI API 协议规范开发的快速图像生成 Web 应用程序。它利用 Rust 编写的高性能后端作为协议转换网关，将前端请求转发至 Gemini Pro 图像生成服务。

## 核心特性

- **多模态图像生成**：支持文本生图（Text-to-Image）和参考图编辑（Image-to-Image）。
- **高并发并行处理**：支持最高 16 路任务并行生成，每个任务拥有独立的进度状态管理。
- **高性能网关**：后端采用 Rust 实现，集成鉴权、限流、重试、超时控制及故障转移（Fallback）等企业级中间件功能。
- **实时交互界面**：基于 React + TypeScript 开发，采用卡片式布局实时展示生成任务进度。
- **本地化存储**：所有生成的图像自动保存至服务器本地，支持前端直接预览与下载。
- **动态配置管理**：支持热加载或重启生效的后端配置（代理地址、存储路径、端口等）。

## 技术栈

- **前端**: React, TypeScript, Tailwind CSS, Lucide React
- **后端**: Rust (Axum / Tokio), Reqwest
- **协议**: OpenAI 兼容协议

## 项目结构

```text
Gemini-Drafting-Factory/
├── frontend/                # React + TypeScript 前端应用
├── backend/                 # Rust 后端代理网关
├── storage/                 # 默认图像存储目录
└── README.md
```

## 快速开始

### 后端配置
1. 进入 `backend` 目录。
2. 配置环境参数。
3. 运行 `cargo run` 启动服务。

### 前端配置
1. 进入 `frontend` 目录。
2. 运行 `npm install` 安装依赖。
3. 运行 `npm run dev` 启动开发服务器。



项目名称：Gemini-Drafting-Factory
项目需求：使用OPENAI的协议去制作一个快速生图的网页。
1，主要使用的是openai的协议，并且使用gemini的geminipro(image)反代理流量去进行生成图片；
2，技术栈：前端可以使用ts+react后端使用rust；
3，功能需求，可以参考正常的gpt或者gemini对话生图逻辑，但不需要有上下文联系关系！可以根据图片去修改也可以直接图文生成；
4，可以支持多图并行生成，有进度条，可以增加多个并行生成比如4个8个最高16个；

注意：
1，可以使用多卡片的展示方式，然后下面有对话框，然后图片生成会保留到本地；
2，着重处理后端把请求转发到你的代理地址，统一处理鉴权、限流、重试、超时、fallback这种内容；
3，转发端口，储存位置等内容可以在前端去进行修改
全称使用中文对话

项目名称：Gemini-Drafting-Factory
项目需求：基于OpenAI API协议规范，开发一个快速图像生成的Web应用程序。核心机制是使用Gemini Pro（图像生成模型）作为后端服务，通过一个符合OpenAI协议的反向代理层来接收和处理图像生成请求。

**技术栈要求：**

- 前端：使用TypeScript结合React框架进行开发，确保代码类型安全和良好的可维护性。
- 后端：使用Rust语言实现高性能、安全的服务器，负责协议转换、请求转发和业务逻辑处理。

**核心功能需求：**

1. **图像生成与编辑**：
    - 支持文本到图像生成：用户输入文本描述，系统生成对应图像。
    - 支持图像到图像编辑：用户上传一张参考图片并附上修改指令，系统根据指令生成修改后的新图像。
    - 功能逻辑可参考主流AI对话生图产品（如GPT、Gemini），但**无需实现多轮对话的上下文关联**，每次请求均为独立任务。

2. **并行生成与任务管理**：
    - 支持多任务并行图像生成，用户可动态设置并行任务数量（例如：4个、8个，最高支持16个并行任务）。
    - 每个生成任务需在前端界面实时显示独立的进度条，清晰展示任务状态（等待中、生成中、完成、失败）。
    - 采用多卡片（Card）的布局方式展示所有生成任务及其结果。

3. **用户界面与交互**：
    - 主界面分为上下两部分：
        - 上部：用于展示生成中的任务卡片和已完成的图像结果卡片。
        - 下部：固定的对话框区域，包含文本输入框、图片上传控件、“生成”按钮以及并行任务数量选择器。
    - 所有成功生成的图像文件必须自动保存到服务器本地指定目录，并在前端卡片中提供查看和下载链接。

**后端架构与代理转发要求：**

1. **核心代理与统一网关**：后端服务需充当统一网关，接收前端符合OpenAI格式的请求，并将其转发至配置好的Gemini Pro（图像生成）代理服务地址。此层是技术实现的重点。
2. **关键中间件功能**：在后端代理转发层中，必须集中实现以下企业级功能：
    - **鉴权**：验证客户端请求的合法性。
    - **限流**：根据用户或IP实施请求频率限制，防止滥用。
    - **重试机制**：对上游服务（Gemini代理）的临时性失败进行自动重试。
    - **超时控制**：设置合理的请求超时时间，避免长时间阻塞。
    - **故障转移（Fallback）**：当主代理服务不可用时，应具备切换到备用服务或返回友好错误信息的能力。

**配置与可维护性：**
- 提供一个前端管理界面或配置面板，允许授权用户动态修改以下后端配置（修改后需重启服务或热加载生效）：
  - 反向代理的目标地址（即Gemini服务代理地址）。
  - 图像文件在服务器上的存储根目录路径。
  - 后端服务监听的网络端口号。

**交付与沟通：**
- 项目开发全过程需使用中文进行沟通、编写代码注释及技术文档。
